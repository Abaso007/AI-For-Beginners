<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "088837b42b7d99198bf62db8a42411e0",
  "translation_date": "2025-08-26T06:41:34+00:00",
  "source_file": "lessons/4-ComputerVision/07-ConvNets/README.md",
  "language_code": "ru"
}
-->
# Свёрточные нейронные сети

Мы уже видели, что нейронные сети хорошо справляются с обработкой изображений, и даже однослойный перцептрон способен с приемлемой точностью распознавать рукописные цифры из набора данных MNIST. Однако MNIST — это особый набор данных, где все цифры центрированы внутри изображения, что упрощает задачу.

## [Викторина перед лекцией](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/107)

В реальной жизни мы хотим уметь распознавать объекты на изображении независимо от их точного расположения. Компьютерное зрение отличается от общей классификации, потому что, когда мы пытаемся найти определённый объект на изображении, мы сканируем его в поисках специфических **шаблонов** и их комбинаций. Например, при поиске кошки мы можем сначала искать горизонтальные линии, которые могут быть усами, а затем определённая комбинация усов может подсказать нам, что это действительно изображение кошки. Важны относительное положение и наличие определённых шаблонов, а не их точное расположение на изображении.

Для извлечения шаблонов мы будем использовать понятие **свёрточных фильтров**. Как вы знаете, изображение представлено в виде двумерной матрицы или трёхмерного тензора с глубиной цвета. Применение фильтра означает, что мы берём относительно небольшую матрицу **ядра фильтра** и для каждого пикселя исходного изображения вычисляем взвешенное среднее с соседними точками. Это можно представить как небольшое окно, скользящее по всему изображению и усредняющее все пиксели в соответствии с весами в матрице ядра фильтра.

![Фильтр вертикальных краёв](../../../../../translated_images/filter-vert.b7148390ca0bc356ddc7e55555d2481819c1e86ddde9dce4db5e71a69d6f887f.ru.png) | ![Фильтр горизонтальных краёв](../../../../../translated_images/filter-horiz.59b80ed4feb946efbe201a7fe3ca95abb3364e266e6fd90820cb893b4d3a6dda.ru.png)
----|----

> Изображение Дмитрия Сошникова

Например, если мы применим фильтры вертикальных и горизонтальных краёв размером 3x3 к цифрам из MNIST, мы получим выделения (например, высокие значения) там, где в исходном изображении есть вертикальные и горизонтальные края. Таким образом, эти два фильтра можно использовать для "поиска" краёв. Аналогично, мы можем создавать различные фильтры для поиска других низкоуровневых шаблонов:

> Изображение [банка фильтров Leung-Malik](https://www.robots.ox.ac.uk/~vgg/research/texclass/filters.html)

Однако, хотя мы можем вручную создавать фильтры для извлечения некоторых шаблонов, мы также можем спроектировать сеть так, чтобы она автоматически обучалась находить шаблоны. Это одна из ключевых идей, лежащих в основе CNN.

## Основные идеи CNN

Работа CNN основана на следующих важных принципах:

* Свёрточные фильтры могут извлекать шаблоны
* Мы можем спроектировать сеть так, чтобы фильтры обучались автоматически
* Мы можем использовать тот же подход для поиска шаблонов в высокоуровневых признаках, а не только в исходном изображении. Таким образом, извлечение признаков в CNN работает на иерархии признаков, начиная с низкоуровневых комбинаций пикселей и доходя до высокоуровневых комбинаций частей изображения.

![Иерархическое извлечение признаков](../../../../../translated_images/FeatureExtractionCNN.d9b456cbdae7cb643fde3032b81b2940e3cf8be842e29afac3f482725ba7f95c.ru.png)

> Изображение из [статьи Hislop-Lynch](https://www.semanticscholar.org/paper/Computer-vision-based-pedestrian-trajectory-Hislop-Lynch/26e6f74853fc9bbb7487b06dc2cf095d36c9021d), основанное на [их исследовании](https://dl.acm.org/doi/abs/10.1145/1553374.1553453)

## ✍️ Упражнения: Свёрточные нейронные сети

Давайте продолжим изучать, как работают свёрточные нейронные сети и как можно добиться обучаемых фильтров, выполняя задания в соответствующих ноутбуках:

* [Свёрточные нейронные сети — PyTorch](../../../../../lessons/4-ComputerVision/07-ConvNets/ConvNetsPyTorch.ipynb)
* [Свёрточные нейронные сети — TensorFlow](../../../../../lessons/4-ComputerVision/07-ConvNets/ConvNetsTF.ipynb)

## Пирамидальная архитектура

Большинство CNN, используемых для обработки изображений, следуют так называемой пирамидальной архитектуре. Первый свёрточный слой, применяемый к исходным изображениям, обычно имеет относительно небольшое количество фильтров (8-16), которые соответствуют различным комбинациям пикселей, таким как горизонтальные/вертикальные линии или штрихи. На следующем уровне мы уменьшаем пространственное измерение сети и увеличиваем количество фильтров, что соответствует большему количеству возможных комбинаций простых признаков. С каждым слоем, по мере продвижения к финальному классификатору, пространственные размеры изображения уменьшаются, а количество фильтров растёт.

В качестве примера давайте рассмотрим архитектуру VGG-16, сети, которая достигла точности 92.7% в топ-5 классификации ImageNet в 2014 году:

![Слои ImageNet](../../../../../translated_images/vgg-16-arch1.d901a5583b3a51baeaab3e768567d921e5d54befa46e1e642616c5458c934028.ru.jpg)

![Пирамида ImageNet](../../../../../translated_images/vgg-16-arch.64ff2137f50dd49fdaa786e3f3a975b3f22615efd13efb19c5d22f12e01451a1.ru.jpg)

> Изображение с [Researchgate](https://www.researchgate.net/figure/Vgg16-model-structure-To-get-the-VGG-NIN-model-we-replace-the-2-nd-4-th-6-th-7-th_fig2_335194493)

## Наиболее известные архитектуры CNN

[Продолжите изучение наиболее известных архитектур CNN](CNN_Architectures.md)

**Отказ от ответственности**:  
Этот документ был переведен с использованием сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Хотя мы стремимся к точности, пожалуйста, учитывайте, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его родном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется профессиональный перевод человеком. Мы не несем ответственности за любые недоразумения или неправильные интерпретации, возникающие в результате использования данного перевода.