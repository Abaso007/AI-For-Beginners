<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "bd10f434e444bce61b7f97eeb1ff6a55",
  "translation_date": "2025-08-24T21:06:17+00:00",
  "source_file": "lessons/5-NLP/19-NER/README.md",
  "language_code": "ja"
}
-->
# 固有表現認識

これまでのところ、主に1つのNLPタスク、つまり分類に集中してきました。しかし、ニューラルネットワークを使用して達成できる他のNLPタスクも存在します。その1つが**[固有表現認識](https://wikipedia.org/wiki/Named-entity_recognition)**（NER）で、これはテキスト内の特定のエンティティ（場所、人名、日時、化学式など）を認識することを扱います。

## [講義前のクイズ](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/119)

## NERの使用例

例えば、Amazon AlexaやGoogleアシスタントのような自然言語チャットボットを開発したいとします。インテリジェントなチャットボットが動作する仕組みは、入力された文に対してテキスト分類を行い、ユーザーが何を求めているのかを*理解*することです。この分類の結果がいわゆる**インテント**であり、チャットボットが何をすべきかを決定します。

<img alt="Bot NER" src="images/bot-ner.png" width="50%"/>

> 著者による画像

しかし、ユーザーがフレーズの一部としていくつかのパラメータを提供する場合があります。例えば、天気を尋ねる際に、場所や日付を指定することがあります。ボットはこれらのエンティティを理解し、アクションを実行する前にパラメータスロットを適切に埋める必要があります。これがまさにNERの出番です。

> ✅ 別の例としては、[科学的な医療論文の分析](https://soshnikov.com/science/analyzing-medical-papers-with-azure-and-text-analytics-for-health/)があります。ここで探すべき主なものは、疾患や医薬品などの特定の医療用語です。少数の疾患であれば部分文字列検索で抽出できるかもしれませんが、化学化合物や薬剤名のような複雑なエンティティには、より高度なアプローチが必要です。

## トークン分類としてのNER

NERモデルは本質的に**トークン分類モデル**です。なぜなら、入力された各トークンがエンティティに属するかどうか、そして属する場合はどのエンティティクラスに属するかを決定する必要があるからです。

以下の論文タイトルを考えてみましょう：

**三尖弁逆流**と**炭酸リチウム**の**毒性**が新生児に見られる。

ここでのエンティティは以下の通りです：

* 三尖弁逆流は疾患（`DIS`）
* 炭酸リチウムは化学物質（`CHEM`）
* 毒性も疾患（`DIS`）

1つのエンティティが複数のトークンにまたがることがあります。また、この例のように、2つの連続するエンティティを区別する必要があります。そのため、各エンティティに対して2つのクラスを使用するのが一般的です。1つはエンティティの最初のトークンを指定するクラス（通常は`B-`プレフィックスを使用し、**b**eginningを表す）、もう1つはエンティティの継続部分を指定するクラス（`I-`、**i**nnerトークンを表す）です。また、すべての**o**therトークンを表すクラスとして`O`を使用します。このようなトークンタグ付けは[BIOタグ付け](https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging))（またはIOB）と呼ばれます。タグ付けされたタイトルは次のようになります：

Token | Tag
------|-----
三尖弁 | B-DIS
逆流 | I-DIS
と | O
炭酸 | B-CHEM
リチウム | I-CHEM
毒性 | B-DIS
が | O
新生児 | O
に | O
見られる | O
。 | O

トークンとクラスの1対1の対応を構築する必要があるため、この図から右端の**多対多**ニューラルネットワークモデルをトレーニングできます：

![一般的なリカレントニューラルネットワークのパターンを示す画像。](../../../../../translated_images/unreasonable-effectiveness-of-rnn.541ead816778f42dce6c42d8a56c184729aa2378d059b851be4ce12b993033df.ja.jpg)

> *[Andrej Karpathy](http://karpathy.github.io/)による[このブログ記事](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)からの画像。NERトークン分類モデルは、この画像の右端のネットワークアーキテクチャに対応します。*

## NERモデルのトレーニング

NERモデルは本質的にトークン分類モデルであるため、このタスクには既に学んだRNNを使用できます。この場合、リカレントネットワークの各ブロックがトークンIDを返します。以下のノートブックでは、トークン分類のためのLSTMのトレーニング方法を示しています。

## ✍️ サンプルノートブック: NER

以下のノートブックで学習を続けてください：

* [TensorFlowを使用したNER](../../../../../lessons/5-NLP/19-NER/NER-TF.ipynb)

## 結論

NERモデルは**トークン分類モデル**であり、トークン分類を実行するために使用できます。これはNLPで非常に一般的なタスクであり、テキスト内の場所、名前、日付などの特定のエンティティを認識するのに役立ちます。

## 🚀 チャレンジ

以下の課題を完了して、医療用語の固有表現認識モデルをトレーニングし、別のデータセットで試してみてください。

## [講義後のクイズ](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/219)

## 復習と自己学習

[リカレントニューラルネットワークの驚くべき有効性](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)というブログを読み、その記事の「さらなる読み物」セクションに従って知識を深めてください。

## [課題](lab/README.md)

このレッスンの課題では、医療エンティティ認識モデルをトレーニングする必要があります。このレッスンで説明されているようにLSTMモデルのトレーニングから始め、BERTトランスフォーマーモデルの使用に進んでください。[指示](lab/README.md)を読んで詳細を確認してください。

**免責事項**:  
この文書は、AI翻訳サービス [Co-op Translator](https://github.com/Azure/co-op-translator) を使用して翻訳されています。正確性を追求しておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があることをご承知おきください。元の言語で記載された文書が公式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。この翻訳の使用に起因する誤解や誤認について、当方は一切の責任を負いません。